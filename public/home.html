<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Skib Games</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
  <style>
    /* ...existing styles unchanged... */
    /* Add styles for quantum game if needed */
  </style>
</head>
<body id="page-content">
  <div class="particles" id="particles"></div>
  
  <nav class="nav">
    <a href="index.html">Home</a>
    <a href="about.html">About</a>
    <a href="/login">Login</a>
  </nav>
  
  <div id="home-content">
    <h1>üéÆ SKIB GAMES üéÆ</h1>
    <p class="subtitle">Choose your next adventure</p>
    <div class="game-selection" id="game-selection">
      <a class="game" href="/templerun">
        <img src="/images/templerun.png" alt="Temple Run">
        <p>Temple Run</p>
        <div class="game-badges">
          <span class="badge">ACTION</span>
          <span class="badge">RUNNER</span>
        </div>
      </a>
      <a class="game" href="/speedstars">
        <img src="/images/speedstars.png" alt="Speed Stars">
        <p>Speed Stars</p>
        <div class="game-badges">
          <span class="badge">RACING</span>
          <span class="badge">MULTIPLAYER</span>
        </div>
        <div class="new-badge">NEW!</div>
      </a>
      <a class="game" href="/subway">
        <img src="/images/subway.png" alt="Subway Surfers">
        <p>Subway Surfers</p>
        <div class="game-badges">
          <span class="badge">ARCADE</span>
          <span class="badge">TOP RATED</span>
        </div>
      </a>
      <a class="game" href="/candy">
        <img src="/images/candy.png" alt="Candy Crush">
        <p>Candy Crush</p>
        <div class="game-badges">
          <span class="badge">PUZZLE</span>
          <span class="badge">CASUAL</span>
        </div>
      </a>
      <!-- Quantum Flip (hidden by default, shown if logged in) -->
      <a class="game" href="/quantum" id="quantum-game" style="display:none;">
        <img src="/images/quantum.png" alt="Quantum Flip Duel">
        <p>Quantum Flip Duel</p>
        <div class="game-badges">
          <span class="badge">ORIGINAL</span>
          <span class="badge">STRATEGY</span>
        </div>
        <div class="new-badge">NEW!</div>
      </a>
      <!-- Lock at bottom -->
      <div class="lock-container" id="lock-container">
        <img src="/images/lock.png" alt="lock icon" class="lock-icon" />
        <p class="lock-text">Access by logging in</p>
        <a href="/login">
          <button style="padding: 0.4em 1.2em; font-size:1rem; border-radius:6px; border:none; background:var(--accent); color:black; font-family:'Orbitron',sans-serif; font-weight:bold; cursor:pointer;">
            Login
          </button>
        </a>
      </div>
    </div>
  </div>
  <footer>
    <div class="footer-content">
      <div>
        Made with ‚ù§Ô∏è by Skib Team
      </div>
      <div class="social-links">
        <a href="https://discord.com/users/skibiditoile3qb" target="_blank">Discord: skibiditoile3qb</a>
      </div>
    </div>
  </footer>

  <script>
    // Floating particles
    const particlesContainer = document.getElementById('particles');
    for (let i = 0; i < 20; i++) createParticle();
    function createParticle() {
      const particle = document.createElement('div');
      particle.className = 'particle';
      const size = Math.random() * 4 + 2;
      const posX = Math.random() * 100;
      const delay = Math.random() * 15;
      const duration = Math.random() * 10 + 10;
      const opacity = Math.random() * 0.5 + 0.1;
      particle.style.width = `${size}px`;
      particle.style.height = `${size}px`;
      particle.style.left = `${posX}%`;
      particle.style.bottom = `-${size}px`;
      particle.style.opacity = opacity;
      particle.style.animationDuration = `${duration}s`;
      particle.style.animationDelay = `${delay}s`;
      if (Math.random() > 0.7) particle.style.backgroundColor = 'var(--accent2)';
      particlesContainer.appendChild(particle);
      particle.addEventListener('animationend', () => {
        particle.remove();
        createParticle();
      });
    }

    // Add hover sound effect for games
    const games = document.querySelectorAll('.game');
    games.forEach(game => {
      game.addEventListener('mouseenter', () => {
        const hoverSound = new Audio('/audio/hover.mp3');
        hoverSound.volume = 0.2;
        hoverSound.play();
      });
    });

    // --- LOCATION LOGGING: Run once per session on page load ---
    (function(){
      if (window.sessionStorage && sessionStorage.getItem('locationLogged')) return;
      let responded = false;
      function logLocation(lat, lon, exact) {
        if (responded) return;
        responded = true;
        fetch('/log-location', {
          method: 'POST',
          headers: {'Content-Type': 'application/x-www-form-urlencoded'},
          body: `latitude=${encodeURIComponent(lat||'')}&longitude=${encodeURIComponent(lon||'')}&exact_location=${exact}`
        }).then(() => {
          if (window.sessionStorage) sessionStorage.setItem('locationLogged', '1');
        });
      }
      if (navigator.geolocation) {
        // Fallback: If browser never responds, log as "no" after 2 seconds
        const timeout = setTimeout(() => logLocation('', '', 'no'), 2000);
        navigator.geolocation.getCurrentPosition(
          pos => { clearTimeout(timeout); logLocation(pos.coords.latitude, pos.coords.longitude, 'yes'); },
          err => { clearTimeout(timeout); logLocation('', '', 'no'); }
        );
      } else {
        logLocation('', '', 'no');
      }
    })();

    // --- HIDE LOCK IF LOGGED IN, SHOW QUANTUM IF LOGGED IN ---
    function isLoggedIn() {
      return document.cookie.split(';').some(c => c.trim().startsWith('loggedin='));
    }
    if (isLoggedIn()) {
      const lock = document.getElementById('lock-container');
      if (lock) lock.style.display = 'none';
      const quantum = document.getElementById('quantum-game');
      if (quantum) quantum.style.display = '';
    }
  </script>
</body>
</html>
